---
import Layout from './Layout.astro';

const { frontmatter } = Astro.props;

// Lógica de imagen de cabecera
const imagenCabecera = frontmatter.banner ? frontmatter.banner : frontmatter.image;
---

<Layout titulo={frontmatter.title}>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.2/css/lightgallery.min.css" />

    <main class="contenedor seccion-noticia-detalle">
        <article class="contenido-noticia">
            <header style="text-align: center; margin-bottom: 2rem;">
                <h1 style="font-size: 2.5rem; color: var(--color-primario);">{frontmatter.title}</h1>
                <p style="color: #666; font-style: italic;">Publicado el: {frontmatter.date}</p>
                
                <img 
                    src={imagenCabecera} 
                    alt={frontmatter.title} 
                    style="width: 100%; max-height: 500px; object-fit: cover; border-radius: 10px; margin-top: 1rem;"
                >
            </header>

            <div class="texto-articulo" style="line-height: 1.8; font-size: 1.1rem;">
                <slot />
            </div>

            <div style="margin-top: 5rem; margin-bottom: 3rem; text-align: center;">
                <a href="/noticias" class="boton-secundario">← Volver a Noticias</a>
            </div>
        </article>
    </main>
</Layout>

<script is:inline>
    // Esperamos a que la página cargue
    document.addEventListener('DOMContentLoaded', () => {
        // Buscamos el contenedor de la galería
        const galeria = document.querySelector('.galeria-noticia');
        
        if (galeria && window.lightGallery) {
            // Inicializamos la galería
            window.lightGallery(galeria, {
                selector: 'img', // Le decimos que busque directamente las etiquetas <img>
                speed: 500,
                download: false
            });

            // Agregamos un cursor de "lupa" para que la gente sepa que puede dar clic
            const imagenes = galeria.querySelectorAll('img');
            imagenes.forEach(img => {
                img.style.cursor = 'zoom-in';
                // Truco: LightGallery necesita el atributo data-src para saber qué abrir
                img.setAttribute('data-src', img.src);
            });
        }
    });
</script>